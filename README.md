# Nabuware Network Exploit Script Plugin Template

This template is an example hello world script plugin. To learn more about Network Exploit, visit [https://www.nabuware.com](https://www.nabuware.com).

# Installation

To install the plugin, copy this repository contents to:

    %UserProfile%\network-exploit\scripts

For example, `C:\Users\john\network-exploit\scripts`. Create the directory `scripts` inside `%UserProfile%\network-exploit` if you don't already have one.

# Loading the script plugin

Make sure the script is detected by running:

    (01:16:23 PM) C:\> scripts

    Script Name 	 Description 	 Status 
    hello-world 	 Say hello to user 	 Not loaded 

    (01:16:24 PM) C:\> 

To load the plugin, run the following command from any target Terminal:

    (01:16:24 PM) C:\> scripts load hello-world

    Script 'hello-world' has been loaded

    (01:17:09 PM) C:\> 


You should see the message indicating that the script has been loaded successfully.

# Troubleshooting

If you do not see the script listed when running `scripts`, it is possible that you have copied `hello-world` to the wrong path. Double-check that `hello-world` exists inside:

    C:\Users\USER-NAME\network-exploit\scripts

# Running the script

Invoke `hello-world` from any target Terminal. For example, to display the help message:

    (01:26:05 PM) C:\> hello-world -h
    usage: hello-world [-h] name

    Say hello to user

    positional arguments:
    name        operator name

    options:
    -h, --help  show this help message and exit


To use the script:

    (01:26:09 PM) C:\> hello-world John
    Hello John!

    (01:26:25 PM) C:\> hello-world "John Smith"
    Hello John Smith!

    (01:28:29 PM) C:\> 


# Debugging

To debug the script, you need to:

* Enable the debug server
* Connect to the debug server from Visual Studio Code

# Enabling debug server

To enable the debug server:

1. Go to the Setting tab.
2. Scroll to the Development section at the bottom of Settings
3. Click the "Start Server" button

The debug server status should change to "Debug server is running at localhost:5678".

# Troubleshooting

The debug server may fail to start with the message "Can't listen for client connections" if you already have another program using port 5678.

To identify the offending process ID, open PowerShell and run the following command (notice the port number 5678):

    PS C:\Users\john> Get-Process -Id (Get-NetTCPConnection -LocalPort 5678).OwningProcess | Select Id

    Id
    --
    16452


    PS C:\Users\john>

You can terminate this process or choose another port other than 5678. If you choose the latter, make sure you change the port in Visual Studio Code `launch.json` file too.

# Connecting from Visual Studio Code

Open Visual Studio Code. Then open the `scripts` directory:

1. Go to File in the menu
2. Open Folder
3. Select the `%UserProfile%\network-exploit\scripts` folder
4. Open the Explorer tab (Ctrl+Shitf+E)
5. Navigate to `hello-world\__init__.py`

To connect to the debug server:

1. Go to the Run and Debug tab (Ctrl+Shift+D)
2. Click the green arrow next to "RUN AND DEBUG: Python: Remote Debug" on the right of the tabs

Now you can set breakpoints, step through the code and inspect variables.

Refer to Visual Studio Code documentation for more information about debugging: [https://code.visualstudio.com/docs/editor/debugging](https://code.visualstudio.com/docs/editor/debugging).

# Troubleshooting

If the "RUN AND DEBUG: Python: Remote Debug" is missing, ensure you have opened the correct directory, `%UserProfile%\network-exploit\scripts` where the `launch.json` file exists.

Visual Studio Code may fail with the message "connect ECONNREFUSED 127.0.0.1:5678". Ensure you have started the debug server beforehand.

# Support

If you have an issue or question, please email us at [support@nabuware.com](mailto:support@nabuware.com).
